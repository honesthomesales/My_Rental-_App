(()=>{var e={};e.id=664,e.ids=[664],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},8893:e=>{"use strict";e.exports=require("buffer")},4770:e=>{"use strict";e.exports=require("crypto")},7702:e=>{"use strict";e.exports=require("events")},2615:e=>{"use strict";e.exports=require("http")},5240:e=>{"use strict";e.exports=require("https")},8216:e=>{"use strict";e.exports=require("net")},8621:e=>{"use strict";e.exports=require("punycode")},6162:e=>{"use strict";e.exports=require("stream")},2452:e=>{"use strict";e.exports=require("tls")},7360:e=>{"use strict";e.exports=require("url")},1568:e=>{"use strict";e.exports=require("zlib")},1114:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>x,originalPathname:()=>u,pages:()=>d,routeModule:()=>m,tree:()=>o}),s(7432),s(7195),s(1025);var r=s(3282),a=s(5736),l=s(3906),n=s.n(l),i=s(6880),c={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>i[e]);s.d(t,c);let o=["",{children:["properties",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,7432)),"C:\\Projects\\Rental_App\\apps\\web\\app\\properties\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,7195)),"C:\\Projects\\Rental_App\\apps\\web\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.bind(s,1025)),"C:\\Projects\\Rental_App\\apps\\web\\app\\not-found.tsx"]}],d=["C:\\Projects\\Rental_App\\apps\\web\\app\\properties\\page.tsx"],u="/properties/page",x={require:s,loadChunk:()=>Promise.resolve()},m=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/properties/page",pathname:"/properties",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},3698:(e,t,s)=>{Promise.resolve().then(s.bind(s,875))},875:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>T});var r=s(3227),a=s(3677),l=s(1043),n=s(5579),i=s(4431),c=s(4871),o=s(1109);let d=(0,o.Z)("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]),u=(0,o.Z)("Map",[["polygon",{points:"3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21",key:"ok2ie8"}],["line",{x1:"9",x2:"9",y1:"3",y2:"18",key:"w34qz5"}],["line",{x1:"15",x2:"15",y1:"6",y2:"21",key:"volv9a"}]]);var x=s(3239);let m=(0,o.Z)("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]);var p=s(405),h=s(7464),y=s(2456);let g=(0,o.Z)("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);var f=s(5248),b=s(4155),j=s(7587),v=s(401);let N=(0,o.Z)("Unlink",[["path",{d:"m18.84 12.25 1.72-1.71h-.02a5.004 5.004 0 0 0-.12-7.07 5.006 5.006 0 0 0-6.95 0l-1.72 1.71",key:"yqzxt4"}],["path",{d:"m5.17 11.75-1.71 1.71a5.004 5.004 0 0 0 .12 7.07 5.006 5.006 0 0 0 6.95 0l1.71-1.71",key:"4qinb0"}],["line",{x1:"8",x2:"8",y1:"2",y2:"5",key:"1041cp"}],["line",{x1:"2",x2:"5",y1:"8",y2:"8",key:"14m1p5"}],["line",{x1:"16",x2:"16",y1:"19",y2:"22",key:"rzdirn"}],["line",{x1:"19",x2:"22",y1:"16",y2:"16",key:"ox905f"}]]);function w({propertyId:e,propertyName:t,onClose:s,onSuccess:l}){let[i,c]=(0,a.useState)([]),[o,d]=(0,a.useState)(!0),[u,m]=(0,a.useState)(null),[p,h]=(0,a.useState)(null),y=async()=>{try{d(!0);let e=await n.TenantsService.getAll();e.success&&e.data?c(e.data):b.ZP.error("Failed to load tenants")}catch(e){b.ZP.error("Error loading tenants")}finally{d(!1)}},f=async t=>{try{m(t);let s=await n.TenantsService.update(t,{property_id:e});if(s.success){let t=await n.PropertiesService.getById(e);if(t.success&&t.data){let s=t.data;"empty"===s.status&&await n.PropertiesService.update(e,{status:"rented",notes:`${s.notes||""}

[${new Date().toLocaleDateString()}] Property status changed to 'rented' - tenant linked.`})}b.ZP.success("Tenant linked to property successfully! Property status updated to rented."),l(),y()}else b.ZP.error(s.error||"Failed to link tenant")}catch(e){b.ZP.error("Error linking tenant")}finally{m(null)}},w=async t=>{try{h(t);let s=await n.TenantsService.update(t,{property_id:void 0});if(s.success){let s=i.filter(s=>s.property_id===e&&s.id!==t);if(0===s.length){let t=await n.PropertiesService.getById(e);if(t.success&&t.data){let s=t.data;await n.PropertiesService.update(e,{status:"empty",notes:`${s.notes||""}

[${new Date().toLocaleDateString()}] Property status changed to 'empty' - all tenants unlinked.`})}}b.ZP.success("Tenant unlinked from property successfully!"),l(),y()}else b.ZP.error(s.error||"Failed to unlink tenant")}catch(e){b.ZP.error("Error unlinking tenant")}finally{h(null)}},k=i.filter(t=>t.property_id===e),_=i.filter(e=>!e.property_id);return o?r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:r.jsx("div",{className:"bg-white rounded-lg shadow-xl p-6",children:r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600 mx-auto"})})}):r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[(0,r.jsxs)("div",{children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Link Tenants to Property"}),r.jsx("p",{className:"text-gray-600 mt-1",children:t})]}),r.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600",children:r.jsx(j.Z,{className:"w-6 h-6"})})]}),(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[r.jsx(v.Z,{className:"w-5 h-5 mr-2"}),"Currently Linked Tenants (",k.length,")"]}),0===k.length?(0,r.jsxs)("div",{className:"text-center py-8 bg-gray-50 rounded-lg",children:[r.jsx(v.Z,{className:"w-12 h-12 text-gray-400 mx-auto mb-2"}),r.jsx("p",{className:"text-gray-600",children:"No tenants currently linked to this property"})]}):r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:k.map(e=>(0,r.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4",children:[(0,r.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("h4",{className:"font-medium text-gray-900",children:[e.first_name," ",e.last_name]}),e.email&&r.jsx("p",{className:"text-sm text-gray-600",children:e.email}),e.phone&&r.jsx("p",{className:"text-sm text-gray-600",children:e.phone})]}),r.jsx("button",{onClick:()=>w(e.id),disabled:p===e.id,className:"btn btn-sm btn-danger",children:p===e.id?r.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):(0,r.jsxs)(r.Fragment,{children:[r.jsx(N,{className:"w-4 h-4 mr-1"}),"Unlink"]})})]}),e.monthly_rent&&(0,r.jsxs)("p",{className:"text-sm text-green-600 font-medium",children:["$",e.monthly_rent.toLocaleString(),"/month"]})]},e.id))})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[r.jsx(x.Z,{className:"w-5 h-5 mr-2"}),"Available Tenants (",_.length,")"]}),0===_.length?(0,r.jsxs)("div",{className:"text-center py-8 bg-gray-50 rounded-lg",children:[r.jsx(x.Z,{className:"w-12 h-12 text-gray-400 mx-auto mb-2"}),r.jsx("p",{className:"text-gray-600",children:"All tenants are already linked to properties"})]}):r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:_.map(e=>(0,r.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4",children:[(0,r.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("h4",{className:"font-medium text-gray-900",children:[e.first_name," ",e.last_name]}),e.email&&r.jsx("p",{className:"text-sm text-gray-600",children:e.email}),e.phone&&r.jsx("p",{className:"text-sm text-gray-600",children:e.phone})]}),r.jsx("button",{onClick:()=>f(e.id),disabled:u===e.id,className:"btn btn-sm btn-primary",children:u===e.id?r.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):(0,r.jsxs)(r.Fragment,{children:[r.jsx(g,{className:"w-4 h-4 mr-1"}),"Link"]})})]}),e.monthly_rent&&(0,r.jsxs)("p",{className:"text-sm text-green-600 font-medium",children:["$",e.monthly_rent.toLocaleString(),"/month"]})]},e.id))})]})]}),r.jsx("div",{className:"flex justify-end p-6 border-t border-gray-200",children:r.jsx("button",{onClick:s,className:"btn btn-secondary",children:"Close"})})]})})}var k=s(4169);let _=s.n(k)()(async()=>{},{loadableGenerated:{modules:["components\\PropertiesMap.tsx -> ./ClientOnlyMap"]},ssr:!1,loading:()=>r.jsx("div",{className:"bg-gray-100 rounded-lg flex items-center justify-center",style:{height:"400px"},children:r.jsx("div",{className:"text-center text-gray-500",children:r.jsx("div",{className:"text-lg font-medium mb-2",children:"Loading Map..."})})})});function P({properties:e,height:t="400px"}){let[s,l]=(0,a.useState)(!1);if(!s)return r.jsx("div",{className:"bg-gray-100 rounded-lg flex items-center justify-center",style:{height:t},children:r.jsx("div",{className:"text-center text-gray-500",children:r.jsx("div",{className:"text-lg font-medium mb-2",children:"Loading Map..."})})});let n=e.filter(e=>e.latitude&&e.longitude);return 0===n.length?r.jsx("div",{className:"bg-gray-100 rounded-lg flex items-center justify-center",style:{height:t},children:(0,r.jsxs)("div",{className:"text-center text-gray-500",children:[r.jsx("div",{className:"text-lg font-medium mb-2",children:"No Properties with Location Data"}),r.jsx("div",{className:"text-sm",children:"Add latitude and longitude coordinates to your properties to see them on the map"})]})}):r.jsx("div",{className:"rounded-lg overflow-hidden border border-gray-200",style:{height:t},children:r.jsx(_,{properties:n})})}let L=(0,o.Z)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);var S=s(7099);let C=(0,o.Z)("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);function Z({properties:e,onPropertiesUpdated:t}){let[s,l]=(0,a.useState)(!1),[i,c]=(0,a.useState)(0),[o,d]=(0,a.useState)({success:0,failed:0,skipped:0,errors:[]}),u=e.filter(e=>!e.latitude||!e.longitude),x=async e=>{if(!e.address||!e.city||!e.state)return{success:!1,error:"Missing address information"};try{let t=`${e.address}, ${e.city}, ${e.state} ${e.zip_code||""}`.trim(),s=process.env.NEXT_PUBLIC_GOOGLE_MAPS_API_KEY;if(s&&"YOUR_GOOGLE_MAPS_API_KEY_HERE"!==s){let r=await fetch(`https://maps.googleapis.com/maps/api/geocode/json?address=${encodeURIComponent(t)}&key=${s}`);if(!r.ok)return{success:!1,error:"Geocoding service error"};let a=await r.json();if("OK"===a.status&&a.results&&a.results.length>0){let t=a.results[0].geometry.location,s=t.lat,r=t.lng;if((await n.PropertiesService.update(e.id,{latitude:s,longitude:r})).success)return{success:!0};return{success:!1,error:"Failed to update property"}}if("ZERO_RESULTS"===a.status)return{success:!1,error:"Address not found"};if("OVER_QUERY_LIMIT"===a.status)return{success:!1,error:"API quota exceeded"};return{success:!1,error:`Geocoding error: ${a.status}`}}{let s=await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(t)}&limit=1&addressdetails=1`);if(!s.ok)return{success:!1,error:"Geocoding service error"};let r=await s.json();if(!r||!(r.length>0))return{success:!1,error:"Address not found"};{let t=r[0],s=parseFloat(t.lat),a=parseFloat(t.lon);if((await n.PropertiesService.update(e.id,{latitude:s,longitude:a})).success)return{success:!0};return{success:!1,error:"Failed to update property"}}}}catch(e){return{success:!1,error:"Network error"}}},m=async()=>{if(0===u.length){(0,b.ZP)("All properties already have coordinates!");return}l(!0),c(0),d({success:0,failed:0,skipped:0,errors:[]});for(let e=0;e<u.length;e++){let t=u[e];c((e+1)/u.length*100);let s=await x(t);s.success?d(e=>({...e,success:e.success+1})):d(e=>({...e,failed:e.failed+1,errors:[...e.errors,`${t.name}: ${s.error}`]})),await new Promise(e=>setTimeout(e,1e3))}l(!1),o.success>0&&(b.ZP.success(`Successfully geocoded ${o.success} properties!`),t()),o.failed>0&&b.ZP.error(`Failed to geocode ${o.failed} properties`)};return 0===u.length?r.jsx("div",{className:"p-4 bg-green-50 rounded-lg border border-green-200",children:(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx(L,{className:"w-5 h-5 text-green-600 mr-2"}),r.jsx("span",{className:"text-green-800 font-medium",children:"All properties have coordinates!"})]})}):(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-200",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[r.jsx("h3",{className:"text-sm font-medium text-blue-900",children:"Bulk Geocoding"}),(0,r.jsxs)("span",{className:"text-xs text-blue-600",children:[u.length," properties need coordinates"]})]}),r.jsx("p",{className:"text-sm text-blue-700 mb-3",children:"Automatically convert addresses to coordinates for all properties without location data."}),r.jsx("button",{onClick:m,disabled:s,className:"btn btn-primary text-sm w-full",children:s?(0,r.jsxs)(r.Fragment,{children:[r.jsx(S.Z,{className:"w-4 h-4 mr-2 animate-spin"}),"Geocoding Properties... (",Math.round(i),"%)"]}):(0,r.jsxs)(r.Fragment,{children:[r.jsx(p.Z,{className:"w-4 h-4 mr-2"}),"Geocode ",u.length," Properties"]})}),s&&r.jsx("div",{className:"mt-3",children:r.jsx("div",{className:"w-full bg-blue-200 rounded-full h-2",children:r.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${i}%`}})})}),!s&&(o.success>0||o.failed>0)&&(0,r.jsxs)("div",{className:"mt-3 space-y-2",children:[(0,r.jsxs)("div",{className:"flex items-center text-sm",children:[r.jsx(L,{className:"w-4 h-4 text-green-600 mr-2"}),(0,r.jsxs)("span",{className:"text-green-700",children:[o.success," properties updated"]})]}),o.failed>0&&(0,r.jsxs)("div",{className:"flex items-center text-sm",children:[r.jsx(C,{className:"w-4 h-4 text-red-600 mr-2"}),(0,r.jsxs)("span",{className:"text-red-700",children:[o.failed," properties failed"]})]})]})]}),o.errors.length>0&&(0,r.jsxs)("div",{className:"p-3 bg-red-50 rounded-lg border border-red-200",children:[r.jsx("h4",{className:"text-sm font-medium text-red-900 mb-2",children:"Errors:"}),r.jsx("div",{className:"space-y-1 max-h-32 overflow-y-auto",children:o.errors.map((e,t)=>r.jsx("div",{className:"text-xs text-red-700",children:e},t))})]})]})}var M=s(8969);function T(){let e=(0,l.useRouter)(),[t,s]=(0,a.useState)([]),[o,j]=(0,a.useState)(!0),[v,N]=(0,a.useState)(""),[k,_]=(0,a.useState)("all"),[L,S]=(0,a.useState)(!1),[C,T]=(0,a.useState)(null),[D,q]=(0,a.useState)("list"),[A,E]=(0,a.useState)("name"),[$,O]=(0,a.useState)("asc"),R=async()=>{try{j(!0);let e=await n.PropertiesService.getAll();e.success&&e.data?s(e.data):(console.error("❌ Failed to load properties:",e.error),b.ZP.error("Failed to load properties"))}catch(e){console.error("\uD83D\uDCA5 Error loading properties:",e),b.ZP.error("Error loading properties")}finally{j(!1)}},F=(0,a.useMemo)(()=>t.length?[...t].sort((e,t)=>{let s,r;switch(A){case"name":s=e.name?.toLowerCase()||"",r=t.name?.toLowerCase()||"";break;case"status":s=e.status?.toLowerCase()||"",r=t.status?.toLowerCase()||"";break;case"rent":s=e.active_leases?.[0]?.rent||e.monthly_rent||0,r=t.active_leases?.[0]?.rent||t.monthly_rent||0;break;case"address":s=e.address?.toLowerCase()||"",r=t.address?.toLowerCase()||"";break;case"premium":s=e.insurance_premium||0,r=t.insurance_premium||0;break;default:return 0}return s<r?"asc"===$?-1:1:s>r?"asc"===$?1:-1:0}):[],[t,A,$]),I=e=>{A===e?O("asc"===$?"desc":"asc"):(E(e),O("asc"))},G=async e=>{if(confirm("Are you sure you want to delete this property?"))try{let t=await n.PropertiesService.delete(e);t.success?(b.ZP.success("Property deleted successfully"),R()):(console.error("Delete error:",t.error),b.ZP.error("Failed to delete property"))}catch(e){console.error("Error:",e),b.ZP.error("Error deleting property")}},z=async e=>{if(confirm("Are you sure you want to mark this property as vacant? This will end all active leases."))try{if(e.active_leases&&e.active_leases.length>0){let t=new Date;t.setDate(t.getDate()-1);let s=t.toISOString().split("T")[0];for(let t of e.active_leases)await n.LeasesService.update(t.id,{lease_end_date:s,status:"vacant"})}await n.PropertiesService.update(e.id,{status:"empty"}),b.ZP.success("Property marked as vacant successfully"),await R()}catch(e){console.error("Error marking property vacant:",e),b.ZP.error("Error marking property vacant")}},U=e=>{T(e),S(!0)},B=e=>{switch(e){case"rented":return"bg-green-100 text-green-800";case"empty":default:return"bg-gray-100 text-gray-800";case"owner_finance":return"bg-blue-100 text-blue-800";case"lease_purchase":return"bg-purple-100 text-purple-800"}},V=e=>{switch(e){case"rented":return"Rented";case"empty":return"Empty";case"owner_finance":return"Owner Finance";case"lease_purchase":return"Lease Purchase";default:return e}};return o?r.jsx("div",{className:"min-h-screen flex items-center justify-center",children:r.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})}):(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[r.jsx("header",{className:"bg-white shadow-sm border-b border-gray-200",children:r.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,r.jsxs)("div",{className:"flex justify-between items-center py-6",children:[(0,r.jsxs)("div",{children:[r.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Properties"}),r.jsx("p",{className:"text-gray-600",children:"Manage your rental properties"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsxs)("div",{className:"flex space-x-6",children:[(0,r.jsxs)("div",{className:"text-right",children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Total Properties"}),r.jsx("p",{className:"text-2xl font-bold text-blue-600",children:t.length})]}),(0,r.jsxs)("div",{className:"text-right",children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Rented"}),r.jsx("p",{className:"text-2xl font-bold text-green-600",children:t.filter(e=>"rented"===e.status).length})]}),(0,r.jsxs)("div",{className:"text-right",children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Empty"}),r.jsx("p",{className:"text-2xl font-bold text-gray-600",children:t.filter(e=>"empty"===e.status).length})]})]}),r.jsx("div",{className:"flex space-x-3",children:(0,r.jsxs)("button",{onClick:()=>e.push("/properties/new"),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center transition-colors",children:[r.jsx(i.Z,{className:"w-4 h-4 mr-2"}),"Add Property"]})})]})]})})}),(0,r.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[r.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 mb-6",children:r.jsx("div",{className:"p-6",children:(0,r.jsxs)("div",{className:"flex items-center justify-between space-x-4",children:[r.jsx("div",{className:"flex-1",children:(0,r.jsxs)("div",{className:"flex space-x-4",children:[(0,r.jsxs)("div",{className:"relative flex-1",children:[r.jsx(c.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),r.jsx("input",{type:"text",placeholder:"Search properties...",value:v,onChange:e=>N(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),(0,r.jsxs)("select",{value:k,onChange:e=>_(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[r.jsx("option",{value:"all",children:"All Statuses"}),r.jsx("option",{value:"rented",children:"Rented"}),r.jsx("option",{value:"empty",children:"Empty"}),r.jsx("option",{value:"owner_finance",children:"Owner Finance"}),r.jsx("option",{value:"lease_purchase",children:"Lease Purchase"})]})]})}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[r.jsx("button",{onClick:()=>q("list"),className:`p-2 rounded-lg border transition-colors ${"list"===D?"bg-blue-100 border-blue-300 text-blue-700":"bg-white border-gray-300 text-gray-600 hover:bg-gray-50"}`,children:r.jsx(d,{className:"w-4 h-4"})}),r.jsx("button",{onClick:()=>q("map"),className:`p-2 rounded-lg border transition-colors ${"map"===D?"bg-blue-100 border-blue-300 text-blue-700":"bg-white border-gray-300 text-gray-600 hover:bg-gray-50"}`,children:r.jsx(u,{className:"w-4 h-4"})})]})]})})}),r.jsx("div",{className:"mb-6",children:r.jsx(Z,{properties:t,onPropertiesUpdated:R})}),"map"===D&&r.jsx("div",{className:"mb-6",children:r.jsx(P,{properties:F.filter(e=>!!(!v||e.name.toLowerCase().includes(v.toLowerCase())||e.address.toLowerCase().includes(v.toLowerCase()))&&("all"===k||e.status===k)),height:"500px"})}),0===F.filter(e=>!!(!v||e.name.toLowerCase().includes(v.toLowerCase())||e.address.toLowerCase().includes(v.toLowerCase()))&&("all"===k||e.status===k)).length?r.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:(0,r.jsxs)("div",{className:"text-center py-12",children:[r.jsx(x.Z,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),r.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:v?"No properties found":"No properties yet"}),r.jsx("p",{className:"text-gray-600 mb-4",children:v?"Try adjusting your search terms":"Get started by adding your first property"}),!v&&(0,r.jsxs)("button",{onClick:()=>e.push("/properties/new"),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center mx-auto transition-colors",children:[r.jsx(i.Z,{className:"w-4 h-4 mr-2"}),"Add Property"]})]})}):r.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:r.jsx("div",{className:"overflow-x-auto w-full",children:(0,r.jsxs)("table",{className:"w-full min-w-[1600px]",children:[r.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:(0,r.jsxs)("tr",{children:[r.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider min-w-[200px] cursor-pointer hover:bg-gray-100 select-none",onClick:()=>I("name"),children:(0,r.jsxs)("div",{className:"flex items-center",children:["Property","name"===A&&r.jsx("span",{className:"ml-1 text-blue-600",children:"asc"===$?"↑":"↓"})]})}),r.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider min-w-[80px] cursor-pointer hover:bg-gray-100 select-none",onClick:()=>I("address"),children:(0,r.jsxs)("div",{className:"flex items-center",children:["Location","address"===A&&r.jsx("span",{className:"ml-1 text-blue-600",children:"asc"===$?"↑":"↓"})]})}),r.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider min-w-[150px]",children:"Type & Details"}),r.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider min-w-[100px] cursor-pointer hover:bg-gray-100 select-none",onClick:()=>I("rent"),children:(0,r.jsxs)("div",{className:"flex items-center",children:["Rent","rent"===A&&r.jsx("span",{className:"ml-1 text-blue-600",children:"asc"===$?"↑":"↓"})]})}),r.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider min-w-[120px] cursor-pointer hover:bg-gray-100 select-none",onClick:()=>I("premium"),children:(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx(m,{className:"w-4 h-4 mr-1"}),"Insurance","premium"===A&&r.jsx("span",{className:"ml-1 text-blue-600",children:"asc"===$?"↑":"↓"})]})}),r.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider min-w-[100px] cursor-pointer hover:bg-gray-100 select-none",onClick:()=>I("status"),children:(0,r.jsxs)("div",{className:"flex items-center",children:["Status","status"===A&&r.jsx("span",{className:"ml-1 text-blue-600",children:"asc"===$?"↑":"↓"})]})}),r.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider min-w-[150px]",children:"Active Leases"}),r.jsx("th",{className:"px-6 py-4 text-right text-xs font-medium text-gray-500 uppercase tracking-wider min-w-[200px]",children:"Actions"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:F.filter(e=>!!(!v||e.name.toLowerCase().includes(v.toLowerCase())||e.address.toLowerCase().includes(v.toLowerCase()))&&("all"===k||e.status===k)).map(t=>(0,r.jsxs)("tr",{className:"hover:bg-gray-50",children:[r.jsx("td",{className:"px-6 py-4",children:(0,r.jsxs)("div",{className:"min-w-0",children:[r.jsx("div",{className:"text-sm font-medium text-gray-900 truncate",children:t.name}),r.jsx("div",{className:"text-sm text-gray-500 truncate",children:t.address})]})}),r.jsx("td",{className:"px-6 py-4",children:(0,r.jsxs)("div",{className:"flex items-center text-sm text-gray-900",children:[r.jsx(p.Z,{className:"w-4 h-4 mr-1 text-gray-400 flex-shrink-0"}),(0,r.jsxs)("span",{className:"truncate",children:[t.city,", ",t.state]})]})}),(0,r.jsxs)("td",{className:"px-6 py-4",children:[r.jsx("div",{className:"text-sm text-gray-900 capitalize",children:t.property_type||"N/A"}),(t.bedrooms||t.bathrooms)&&(0,r.jsxs)("div",{className:"text-sm text-gray-500",children:[t.bedrooms&&`${t.bedrooms} bed`,t.bedrooms&&t.bathrooms&&" • ",t.bathrooms&&`${t.bathrooms} bath`]}),t.square_feet&&(0,r.jsxs)("div",{className:"text-sm text-gray-500",children:[t.square_feet.toLocaleString()," sq ft"]})]}),r.jsx("td",{className:"px-6 py-4",children:t.monthly_rent?r.jsx("div",{className:"text-sm font-medium text-green-600",children:(()=>{let e=(0,M.S6)(t.notes||void 0);return(0,M.eP)(t.monthly_rent||0,e)})()}):r.jsx("div",{className:"text-sm text-gray-500",children:"N/A"})}),r.jsx("td",{className:"px-6 py-4",children:t.insurance_premium?(0,r.jsxs)("div",{className:"text-sm font-medium text-blue-600",children:["$",t.insurance_premium.toLocaleString(),"/year"]}):r.jsx("div",{className:"text-sm text-gray-500",children:"N/A"})}),r.jsx("td",{className:"px-6 py-4",children:r.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${B(t.status)}`,children:V(t.status)})}),r.jsx("td",{className:"px-6 py-4",children:t.active_lease_count&&t.active_lease_count>0?r.jsx("div",{className:"space-y-1",children:t.active_leases?.map((e,t)=>r.jsxs("div",{className:"flex items-center text-sm text-gray-900",children:[r.jsx(h.Z,{className:"w-4 h-4 mr-1 text-gray-400 flex-shrink-0"}),r.jsxs("span",{className:"truncate",children:["$",e.rent.toLocaleString()," - ",new Date(e.lease_start_date).toLocaleDateString()," to ",new Date(e.lease_end_date).toLocaleDateString()]})]},e.id))}):r.jsx("div",{className:"text-sm text-gray-500",children:"No active leases"})}),r.jsx("td",{className:"px-6 py-4 text-right text-sm font-medium whitespace-nowrap",children:(0,r.jsxs)("div",{className:"flex items-center justify-end space-x-2",children:[(0,r.jsxs)("button",{onClick:()=>e.push(`/properties/edit/?id=${t.id}`),className:"bg-gray-100 text-gray-700 px-3 py-2 rounded text-xs hover:bg-gray-200 flex items-center transition-colors",children:[r.jsx(y.Z,{className:"w-3 h-3 mr-1"}),"Edit"]}),(0,r.jsxs)("button",{onClick:()=>U(t),className:"bg-blue-100 text-blue-700 px-3 py-2 rounded text-xs hover:bg-blue-200 flex items-center transition-colors",children:[r.jsx(g,{className:"w-3 h-3 mr-1"}),"Link"]}),"rented"===t.status&&t.active_lease_count&&t.active_lease_count>0&&(0,r.jsxs)("button",{onClick:()=>z(t),className:"bg-orange-100 text-orange-200 flex items-center transition-colors",title:"Mark property as vacant and end lease",children:[r.jsx(x.Z,{className:"w-3 h-3 mr-1"}),"Vacant"]}),r.jsx("button",{onClick:()=>G(t.id),className:"bg-red-100 text-red-700 px-3 py-2 rounded text-xs hover:bg-red-200 flex items-center transition-colors",children:r.jsx(f.Z,{className:"w-3 h-3"})})]})})]},t.id))})]})})})]}),L&&C&&r.jsx(w,{propertyId:C.id,propertyName:C.name,onClose:()=>{S(!1),T(null)},onSuccess:()=>{R()}})]})}},8969:(e,t,s)=>{"use strict";function r(e,t){if(!e||!t)return e||0;switch(t.toLowerCase().trim()){case"weekly":return 4.33*e;case"bi-weekly":case"biweekly":case"bi_weekly":return 2.17*e;default:return e}}function a(e){if(!e)return"monthly";let t=e.match(/Rent cadence:\s*(\w+)/i);return t?t[1]:"monthly"}function l(e,t){if(!e)return"$0";let s=t?.toLowerCase().trim()||"monthly";return`$${e.toLocaleString()}/${s}`}function n(e,t,s){let r;let a=new Date(e);switch(s.toLowerCase().trim()){case"weekly":r=new Date(a.getTime()+6048e5*t);break;case"bi-weekly":case"biweekly":case"bi_weekly":r=new Date(a.getTime()+12096e5*t);break;default:(r=new Date(a)).setMonth(r.getMonth()+t)}return r}function i(e,t){if(console.log("calculateTotalLatePayments: Starting calculation for",e.first_name,e.last_name),!e||!t||!e.lease_start_date||!t?.monthly_rent)return console.log("calculateTotalLatePayments: Missing required data - tenant:",!!e,"property:",!!t,"lease_start_date:",e?.lease_start_date,"monthly_rent:",t?.monthly_rent),{totalLateFees:0,totalOutstanding:0,totalDue:0,latePeriods:0,payPeriods:[]};try{let s=a(t.notes),r=t.monthly_rent;console.log("calculateTotalLatePayments: Cadence:",s,"Monthly rent:",r);let l=r;"weekly"===s?l=r/4.33:("bi-weekly"===s||"biweekly"===s||"bi_weekly"===s)&&(l=r/2.17),console.log("Tenant calculation - Cadence:",s,"Monthly rent:",r,"Period rent:",l);let i=function(e,t,s=12){let r=[],a=new Date,l=0,i=n(e,0,t),c=0,o=3*s;for(;i<=a&&l<2*s&&c<o;)i=n(e,++l,t),c++;if(c>=o)return console.error("getLastExpectedPaymentDates: Safety limit reached, possible infinite loop detected"),[];l=Math.max(0,l-1);for(let i=Math.max(0,l-s+1);i<=l;i++){let s=n(e,i,t);s<=a&&r.push(s)}return r}(e.lease_start_date,s,12),c=0,o=0,d=0,u=i.map(t=>{let r=function(e,t,s,r){let a=function(e){switch(e.toLowerCase().trim()){case"weekly":return 10;case"bi-weekly":case"biweekly":case"bi_weekly":return 20;default:return 45}}(s),l=e.toISOString().split("T")[0];t&&Array.isArray(t)||(t=[]);let n=new Date(e);n.setDate(n.getDate()-2);let i=new Date(e);i.setDate(i.getDate()+5);let c=t.filter(e=>{let t=new Date(e.date);return t>=n&&t<=i&&"completed"===e.status}),o=c.reduce((e,t)=>e+t.amount,0),d=Math.max(0,r-o),u=new Date,x=0===c.length&&u>i;return(x&&console.log("LATE PERIOD:",{expectedDate:l,periodEnd:i.toISOString().split("T")[0],today:u.toISOString().split("T")[0],outstanding:d,lateFee:d>0?a:0}),x)?{isLate:!0,daysLate:Math.max(0,function(e,t){let s=new Date(e);return Math.ceil(Math.abs(new Date(t).getTime()-s.getTime())/864e5)}(i,u)),lateFees:d>0?a:0,totalPaid:o,outstanding:d}:{isLate:!1,daysLate:0,lateFees:0,totalPaid:o,outstanding:d}}(t,e.payment_history,s,l);return r.isLate&&(c+=r.lateFees,o+=r.outstanding,d++),{expectedDate:t,...r}}),x={totalLateFees:c,totalOutstanding:o,totalDue:c+o,latePeriods:d,payPeriods:u};return console.log("calculateTotalLatePayments: Final result for",e.first_name,e.last_name,":",x),x}catch(e){return console.error("Error calculating late payments:",e),{totalLateFees:0,totalOutstanding:0,totalDue:0,latePeriods:0,payPeriods:[]}}}function c(e,t){try{if(!e||!t)return console.log("isTenantLate: Missing tenant or property data"),!1;console.log("isTenantLate: Starting check for tenant",e.first_name,e.last_name),console.log("isTenantLate: Tenant lease_start_date:",e.lease_start_date),console.log("isTenantLate: Property monthly_rent:",t.monthly_rent);let s=i(e,t),r=s.totalDue>0;return console.log("isTenantLate: Result - Total due:",s.totalDue,"Is late:",r),r}catch(e){return console.error("Error checking if tenant is late:",e),!1}}s.d(t,{GN:()=>r,S6:()=>a,c1:()=>i,eP:()=>l,mq:()=>c})},7464:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});let r=(0,s(1109).Z)("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]])},7099:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});let r=(0,s(1109).Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},405:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});let r=(0,s(1109).Z)("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},2456:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});let r=(0,s(1109).Z)("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]])},4431:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});let r=(0,s(1109).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},4871:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});let r=(0,s(1109).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},5248:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});let r=(0,s(1109).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},4169:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return l}});let r=s(4812);s(3227),s(3677);let a=r._(s(400));function l(e,t){var s;let r={loading:e=>{let{error:t,isLoading:s,pastDelay:r}=e;return null}};"function"==typeof e&&(r.loader=e);let l={...r,...t};return(0,a.default)({...l,modules:null==(s=l.loadableGenerated)?void 0:s.modules})}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},3307:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return a}});let r=s(9526);function a(e){let{reason:t,children:s}=e;throw new r.BailoutToCSRError(t)}},400:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return o}});let r=s(3227),a=s(3677),l=s(3307),n=s(2014);function i(e){return{default:e&&"default"in e?e.default:e}}let c={loader:()=>Promise.resolve(i(()=>null)),loading:null,ssr:!0},o=function(e){let t={...c,...e},s=(0,a.lazy)(()=>t.loader().then(i)),o=t.loading;function d(e){let i=o?(0,r.jsx)(o,{isLoading:!0,pastDelay:!0,error:null}):null,c=t.ssr?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.PreloadCss,{moduleIds:t.modules}),(0,r.jsx)(s,{...e})]}):(0,r.jsx)(l.BailoutToCSR,{reason:"next/dynamic",children:(0,r.jsx)(s,{...e})});return(0,r.jsx)(a.Suspense,{fallback:i,children:c})}return d.displayName="LoadableComponent",d}},2014:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"PreloadCss",{enumerable:!0,get:function(){return l}});let r=s(3227),a=s(4580);function l(e){let{moduleIds:t}=e,s=(0,a.getExpectedRequestStore)("next/dynamic css"),l=[];if(s.reactLoadableManifest&&t){let e=s.reactLoadableManifest;for(let s of t){if(!e[s])continue;let t=e[s].files.filter(e=>e.endsWith(".css"));l.push(...t)}}return 0===l.length?null:(0,r.jsx)(r.Fragment,{children:l.map(e=>(0,r.jsx)("link",{precedence:"dynamic",rel:"stylesheet",href:s.assetPrefix+"/_next/"+encodeURI(e),as:"style"},e))})}},7432:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});let r=(0,s(3189).createProxy)(String.raw`C:\Projects\Rental_App\apps\web\app\properties\page.tsx#default`)}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[784,891,152],()=>s(1114));module.exports=r})();