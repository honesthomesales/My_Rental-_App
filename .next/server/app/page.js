(()=>{var e={};e.id=931,e.ids=[931],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},8893:e=>{"use strict";e.exports=require("buffer")},4770:e=>{"use strict";e.exports=require("crypto")},7702:e=>{"use strict";e.exports=require("events")},2615:e=>{"use strict";e.exports=require("http")},5240:e=>{"use strict";e.exports=require("https")},8216:e=>{"use strict";e.exports=require("net")},8621:e=>{"use strict";e.exports=require("punycode")},6162:e=>{"use strict";e.exports=require("stream")},2452:e=>{"use strict";e.exports=require("tls")},7360:e=>{"use strict";e.exports=require("url")},1568:e=>{"use strict";e.exports=require("zlib")},5513:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>x,originalPathname:()=>p,pages:()=>d,routeModule:()=>u,tree:()=>o}),s(1254),s(7195),s(1025);var a=s(3282),r=s(5736),l=s(3906),n=s.n(l),i=s(6880),c={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>i[e]);s.d(t,c);let o=["",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,1254)),"C:\\Projects\\Rental_App\\apps\\web\\app\\page.tsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,7195)),"C:\\Projects\\Rental_App\\apps\\web\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.bind(s,1025)),"C:\\Projects\\Rental_App\\apps\\web\\app\\not-found.tsx"]}],d=["C:\\Projects\\Rental_App\\apps\\web\\app\\page.tsx"],p="/page",x={require:s,loadChunk:()=>Promise.resolve()},u=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/page",pathname:"/",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},7850:(e,t,s)=>{Promise.resolve().then(s.bind(s,736))},736:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>h});var a=s(3227),r=s(3677),l=s(1043),n=s(4431),i=s(3540),c=s(3239),o=s(401),d=s(582),p=s(4871),x=s(4155),u=s(5579),m=s(8969);function h(){let e=(0,l.useRouter)(),[t,s]=(0,r.useState)([]),[h,y]=(0,r.useState)({total_properties:0,total_tenants:0,outstanding_balances:0,monthly_income:0,monthly_expenses:0,profit:0,total_bank_balance:0,late_tenants_count:0,property_type_breakdown:{house:0,singlewide:0,doublewide:0,land:0,loan:0}}),[g,b]=(0,r.useState)(!0),[j,_]=(0,r.useState)(""),[f,w]=(0,r.useState)(!1);(0,r.useCallback)(async()=>{try{b(!0);let[e,t]=await Promise.all([u.PropertiesService.getAll(),u.TenantsService.getAll()]),a=e.data,r=t.data;if(a){let e=a.map(e=>({...e,bedrooms:e.bedrooms??null,bathrooms:e.bathrooms??null,square_feet:e.square_feet??null,year_built:e.year_built??null,purchase_price:e.purchase_price??null,purchase_date:e.purchase_date??null,current_value:e.current_value??null,monthly_rent:e.monthly_rent??null,insurance_policy_number:e.insurance_policy_number??null,insurance_provider:e.insurance_provider??null,insurance_expiry_date:e.insurance_expiry_date??null,insurance_premium:e.insurance_premium??null,owner_name:e.owner_name??null,owner_phone:e.owner_phone??null,owner_email:e.owner_email??null,notes:e.notes??null}));s(e);let t=N(e,r||[]);y(t)}}catch(e){console.error("Error loading dashboard data:",e),x.ZP.error("Failed to load dashboard data")}finally{b(!1)}},[]);let N=(0,r.useCallback)((e,t)=>{let s=e.reduce((e,t)=>{let s=(0,m.S6)(t.notes||void 0);return e+(0,m.GN)(t.monthly_rent||0,s)},0),a=e.reduce((e,t)=>{let s=t.property_type||"house";return e[s]=(e[s]||0)+1,e},{});e&&e.length>0&&e.filter(e=>"rented"===e.status).length;let r=0,l=0;return t&&t.length>0&&(r=t.filter(t=>{try{let s=e.find(e=>e.id===t.property_id);if(!s||!t.leases||0===t.leases.length)return!1;return u.TenantsService.isTenantLate(t,s)}catch(e){return console.error("Error checking tenant late status:",e),!1}}).length,l=t.reduce((t,s)=>{try{let a=e.find(e=>e.id===s.property_id);if(a&&s.leases&&s.leases.length>0){let e=u.TenantsService.calculateTotalLatePayments(s,a);return t+e.totalDue}}catch(e){console.error("Error calculating outstanding for tenant:",e)}return t},0)),{total_properties:e.length,total_tenants:t?.length||0,outstanding_balances:l,monthly_income:s,monthly_expenses:0,profit:s-0,total_bank_balance:0,late_tenants_count:r,property_type_breakdown:{house:a.house||0,singlewide:a.singlewide||0,doublewide:a.doublewide||0,land:a.land||0,loan:a.loan||0}}},[]),v=(0,r.useMemo)(()=>{if(!j.trim())return t;let e=j.toLowerCase();return t.filter(t=>t.name.toLowerCase().includes(e)||t.address.toLowerCase().includes(e)||t.city.toLowerCase().includes(e)||t.state.toLowerCase().includes(e))},[t,j]),k=(0,r.useCallback)(e=>{_(e.target.value)},[]);(0,r.useCallback)(t=>{e.push(`/properties/${t}`)},[e]);let P=(0,r.useCallback)(()=>{e.push("/properties/new")},[e]);(0,r.useCallback)(()=>{e.push("/properties")},[e]),(0,r.useCallback)(()=>{e.push("/tenants")},[e]);let L=(0,r.useCallback)(()=>{e.push("/late-payments")},[e]);return f?g?a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary-600"})}):(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[a.jsx("header",{className:"bg-white shadow-sm border-b border-gray-200",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"flex justify-between items-center py-6",children:[(0,a.jsxs)("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Rental Dashboard"}),a.jsx("p",{className:"text-gray-600",children:"Manage your rental properties"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("button",{onClick:P,className:"btn btn-primary btn-lg",children:[a.jsx(n.Z,{className:"w-5 h-5 mr-2"}),"Add Property"]}),(0,a.jsxs)("button",{onClick:L,className:"btn btn-warning btn-lg",children:[a.jsx(i.Z,{className:"w-5 h-5 mr-2"}),"Late Payments"]})]})]})})}),(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6 mb-8",children:[a.jsx("div",{className:"card",children:a.jsx("div",{className:"card-content",children:(0,a.jsxs)("div",{className:"flex items-center",children:[a.jsx("div",{className:"p-2 bg-primary-100 rounded-lg",children:a.jsx(c.Z,{className:"w-6 h-6 text-primary-600"})}),(0,a.jsxs)("div",{className:"ml-4",children:[a.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Properties"}),a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:h.total_properties})]})]})})}),a.jsx("div",{className:"card",children:a.jsx("div",{className:"card-content",children:(0,a.jsxs)("div",{className:"flex items-center",children:[a.jsx("div",{className:"p-2 bg-success-100 rounded-lg",children:a.jsx(o.Z,{className:"w-6 h-6 text-success-600"})}),(0,a.jsxs)("div",{className:"ml-4",children:[a.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Occupied"}),a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:t.filter(e=>"rented"===e.status).length})]})]})})}),a.jsx("div",{className:"card",children:a.jsx("div",{className:"card-content",children:(0,a.jsxs)("div",{className:"flex items-center",children:[a.jsx("div",{className:"p-2 bg-warning-100 rounded-lg",children:a.jsx(d.Z,{className:"w-6 h-6 text-warning-600"})}),(0,a.jsxs)("div",{className:"ml-4",children:[a.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Monthly Income"}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-gray-900",children:["$",h.monthly_income.toLocaleString()]})]})]})})}),a.jsx("div",{className:"card cursor-pointer hover:shadow-lg transition-shadow",onClick:L,children:a.jsx("div",{className:"card-content",children:(0,a.jsxs)("div",{className:"flex items-center",children:[a.jsx("div",{className:"p-2 bg-danger-100 rounded-lg",children:a.jsx(i.Z,{className:"w-6 h-6 text-danger-600"})}),(0,a.jsxs)("div",{className:"ml-4",children:[a.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Late Payments"}),a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:h.late_tenants_count})]})]})})}),a.jsx("div",{className:"card cursor-pointer hover:shadow-lg transition-shadow",onClick:()=>e.push("/late-payments"),children:a.jsx("div",{className:"card-content",children:(0,a.jsxs)("div",{className:"flex items-center",children:[a.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:a.jsx(d.Z,{className:"w-6 h-6 text-red-600"})}),(0,a.jsxs)("div",{className:"ml-4",children:[a.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Outstanding"}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-red-600",children:["$",h.outstanding_balances.toLocaleString()]})]})]})})})]}),(0,a.jsxs)("div",{className:"card mb-6",children:[(0,a.jsxs)("div",{className:"card-header",children:[a.jsx("h2",{className:"card-title",children:"Property Type Breakdown"}),a.jsx("p",{className:"card-description",children:"Distribution of your properties by type"})]}),a.jsx("div",{className:"card-content",children:(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[(0,a.jsxs)("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[a.jsx("div",{className:"text-2xl font-bold text-blue-600",children:h.total_properties}),a.jsx("div",{className:"text-sm text-gray-600",children:"Total"})]}),(0,a.jsxs)("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[a.jsx("div",{className:"text-2xl font-bold text-green-600",children:h.property_type_breakdown.house}),a.jsx("div",{className:"text-sm text-gray-600",children:"House"})]}),(0,a.jsxs)("div",{className:"text-center p-4 bg-purple-50 rounded-lg",children:[a.jsx("div",{className:"text-2xl font-bold text-purple-600",children:h.property_type_breakdown.doublewide}),a.jsx("div",{className:"text-sm text-gray-600",children:"Doublewide"})]}),(0,a.jsxs)("div",{className:"text-center p-4 bg-orange-50 rounded-lg",children:[a.jsx("div",{className:"text-2xl font-bold text-orange-600",children:h.property_type_breakdown.singlewide}),a.jsx("div",{className:"text-sm text-gray-600",children:"Singlewide"})]}),(0,a.jsxs)("div",{className:"text-center p-4 bg-red-50 rounded-lg",children:[a.jsx("div",{className:"text-2xl font-bold text-red-600",children:h.property_type_breakdown.loan}),a.jsx("div",{className:"text-sm text-gray-600",children:"Loan"})]})]})})]}),(0,a.jsxs)("div",{className:"card",children:[a.jsx("div",{className:"card-header",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[a.jsx("h2",{className:"card-title",children:"Properties"}),a.jsx("p",{className:"card-description",children:"Manage your rental properties"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("div",{className:"relative",children:[a.jsx(p.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),a.jsx("input",{type:"text",placeholder:"Search properties...",value:j,onChange:k,className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),a.jsx("button",{className:"btn btn-secondary",children:"Filter"})]})]})}),a.jsx("div",{className:"card-content",children:a.jsx("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Property"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Address"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Monthly Rent"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:v.map(t=>(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[a.jsx("div",{className:"text-sm font-medium text-gray-900",children:t.name}),(0,a.jsxs)("div",{className:"text-sm text-gray-500",children:[t.city,", ",t.state]})]}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:t.address}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800",children:t.property_type})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${"rented"===t.status?"bg-green-100 text-green-800":"empty"===t.status?"bg-gray-100 text-gray-800":"bg-yellow-100 text-yellow-800"}`,children:t.status})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:t.monthly_rent?`${t.monthly_rent.toLocaleString()} (${(0,m.S6)(t.notes||void 0)})`:"N/A"}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:a.jsx("button",{onClick:()=>e.push(`/properties/edit/?id=${t.id}`),className:"text-primary-600 hover:text-primary-900",children:"Edit"})})]},t.id))})]})})})]})]})]}):null}},8969:(e,t,s)=>{"use strict";function a(e,t){if(!e||!t)return e||0;switch(t.toLowerCase().trim()){case"weekly":return 4.33*e;case"bi-weekly":case"biweekly":case"bi_weekly":return 2.17*e;default:return e}}function r(e){if(!e)return"monthly";let t=e.match(/Rent cadence:\s*(\w+)/i);return t?t[1]:"monthly"}function l(e,t){if(!e)return"$0";let s=t?.toLowerCase().trim()||"monthly";return`$${e.toLocaleString()}/${s}`}function n(e,t,s){let a;let r=new Date(e);switch(s.toLowerCase().trim()){case"weekly":a=new Date(r.getTime()+6048e5*t);break;case"bi-weekly":case"biweekly":case"bi_weekly":a=new Date(r.getTime()+12096e5*t);break;default:(a=new Date(r)).setMonth(a.getMonth()+t)}return a}function i(e,t){if(console.log("calculateTotalLatePayments: Starting calculation for",e.first_name,e.last_name),!e||!t||!e.lease_start_date||!t?.monthly_rent)return console.log("calculateTotalLatePayments: Missing required data - tenant:",!!e,"property:",!!t,"lease_start_date:",e?.lease_start_date,"monthly_rent:",t?.monthly_rent),{totalLateFees:0,totalOutstanding:0,totalDue:0,latePeriods:0,payPeriods:[]};try{let s=r(t.notes),a=t.monthly_rent;console.log("calculateTotalLatePayments: Cadence:",s,"Monthly rent:",a);let l=a;"weekly"===s?l=a/4.33:("bi-weekly"===s||"biweekly"===s||"bi_weekly"===s)&&(l=a/2.17),console.log("Tenant calculation - Cadence:",s,"Monthly rent:",a,"Period rent:",l);let i=function(e,t,s=12){let a=[],r=new Date,l=0,i=n(e,0,t),c=0,o=3*s;for(;i<=r&&l<2*s&&c<o;)i=n(e,++l,t),c++;if(c>=o)return console.error("getLastExpectedPaymentDates: Safety limit reached, possible infinite loop detected"),[];l=Math.max(0,l-1);for(let i=Math.max(0,l-s+1);i<=l;i++){let s=n(e,i,t);s<=r&&a.push(s)}return a}(e.lease_start_date,s,12),c=0,o=0,d=0,p=i.map(t=>{let a=function(e,t,s,a){let r=function(e){switch(e.toLowerCase().trim()){case"weekly":return 10;case"bi-weekly":case"biweekly":case"bi_weekly":return 20;default:return 45}}(s),l=e.toISOString().split("T")[0];t&&Array.isArray(t)||(t=[]);let n=new Date(e);n.setDate(n.getDate()-2);let i=new Date(e);i.setDate(i.getDate()+5);let c=t.filter(e=>{let t=new Date(e.date);return t>=n&&t<=i&&"completed"===e.status}),o=c.reduce((e,t)=>e+t.amount,0),d=Math.max(0,a-o),p=new Date,x=0===c.length&&p>i;return(x&&console.log("LATE PERIOD:",{expectedDate:l,periodEnd:i.toISOString().split("T")[0],today:p.toISOString().split("T")[0],outstanding:d,lateFee:d>0?r:0}),x)?{isLate:!0,daysLate:Math.max(0,function(e,t){let s=new Date(e);return Math.ceil(Math.abs(new Date(t).getTime()-s.getTime())/864e5)}(i,p)),lateFees:d>0?r:0,totalPaid:o,outstanding:d}:{isLate:!1,daysLate:0,lateFees:0,totalPaid:o,outstanding:d}}(t,e.payment_history,s,l);return a.isLate&&(c+=a.lateFees,o+=a.outstanding,d++),{expectedDate:t,...a}}),x={totalLateFees:c,totalOutstanding:o,totalDue:c+o,latePeriods:d,payPeriods:p};return console.log("calculateTotalLatePayments: Final result for",e.first_name,e.last_name,":",x),x}catch(e){return console.error("Error calculating late payments:",e),{totalLateFees:0,totalOutstanding:0,totalDue:0,latePeriods:0,payPeriods:[]}}}function c(e,t){try{if(!e||!t)return console.log("isTenantLate: Missing tenant or property data"),!1;console.log("isTenantLate: Starting check for tenant",e.first_name,e.last_name),console.log("isTenantLate: Tenant lease_start_date:",e.lease_start_date),console.log("isTenantLate: Property monthly_rent:",t.monthly_rent);let s=i(e,t),a=s.totalDue>0;return console.log("isTenantLate: Result - Total due:",s.totalDue,"Is late:",a),a}catch(e){return console.error("Error checking if tenant is late:",e),!1}}s.d(t,{GN:()=>a,S6:()=>r,c1:()=>i,eP:()=>l,mq:()=>c})},4431:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});let a=(0,s(1109).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},4871:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});let a=(0,s(1109).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},1254:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});let a=(0,s(3189).createProxy)(String.raw`C:\Projects\Rental_App\apps\web\app\page.tsx#default`)}};var t=require("../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[784,891,152],()=>s(5513));module.exports=a})();