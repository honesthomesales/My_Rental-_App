(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[715],{342:function(e,t,s){Promise.resolve().then(s.bind(s,2589))},2589:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return h}});var a=s(7573),n=s(1695),l=s(7653),i=s(3351),c=s(8113),r=s(8204),o=s(6286),d=s(269),m=s(6991),x=s(2548);let p=r.Ry({property_id:r.Z_().min(1,"Property is required"),first_name:r.Z_().min(1,"First name is required"),last_name:r.Z_().min(1,"Last name is required"),email:r.Z_().email("Invalid email").optional().or(r.i0("")),phone:r.Z_().optional(),emergency_contact_name:r.Z_().optional(),emergency_contact_phone:r.Z_().optional(),lease_start_date:r.Z_().optional(),lease_end_date:r.Z_().optional(),monthly_rent:r.Rx().min(0,"Rent must be positive").optional(),security_deposit:r.Rx().min(0,"Security deposit must be positive").optional(),rent_cadence:r.Z_().optional(),notes:r.Z_().optional()});function u(e){let{tenant:t,onSuccess:s,onCancel:n}=e,[r,u]=(0,l.useState)(!1),[h,b]=(0,l.useState)([]),{register:y,handleSubmit:_,formState:{errors:j},reset:v}=(0,i.cI)({resolver:(0,c.F)(p)});(0,l.useEffect)(()=>{N()},[]),(0,l.useEffect)(()=>{if(t){var e;console.log("TenantForm: Received tenant data:",t),console.log("TenantForm: Leases array:",t.leases);let s=null===(e=t.leases)||void 0===e?void 0:e[0];console.log("TenantForm: Active lease:",s),v({property_id:t.property_id||void 0,first_name:t.first_name,last_name:t.last_name,email:t.email||void 0,phone:t.phone||void 0,emergency_contact_name:t.emergency_contact_name||void 0,emergency_contact_phone:t.emergency_contact_phone||void 0,lease_start_date:(null==s?void 0:s.lease_start_date)||t.lease_start_date||void 0,lease_end_date:(null==s?void 0:s.lease_end_date)||t.lease_end_date||void 0,monthly_rent:(null==s?void 0:s.rent)||t.monthly_rent||void 0,security_deposit:t.security_deposit||void 0,rent_cadence:(null==s?void 0:s.rent_cadence)||void 0,notes:t.notes||void 0})}},[t,v]);let N=async()=>{try{let e=await o.PropertiesService.getAll();e.success&&e.data&&b(e.data)}catch(e){console.error("Failed to load properties:",e)}},f=async e=>{try{if(u(!0),t){let a=await o.TenantsService.update(t.id,e);a.success&&a.data?s(a.data):x.ZP.error("Failed to update tenant")}else{let t={...e},a=await o.TenantsService.create(t);a.success&&a.data?s(a.data):x.ZP.error("Failed to create tenant")}}catch(e){x.ZP.error("Error saving tenant")}finally{u(!1)}};return(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:t?"Edit Tenant":"Add New Tenant"}),(0,a.jsx)("button",{onClick:n,className:"text-gray-400 hover:text-gray-600",children:(0,a.jsx)(d.Z,{className:"w-6 h-6"})})]}),(0,a.jsxs)("form",{onSubmit:_(f),className:"p-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsx)("div",{className:"md:col-span-2",children:(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Basic Information"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"First Name *"}),(0,a.jsx)("input",{...y("first_name"),className:"input",placeholder:"Enter first name"}),j.first_name&&(0,a.jsx)("p",{className:"text-sm text-red-600 mt-1",children:j.first_name.message})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Last Name *"}),(0,a.jsx)("input",{...y("last_name"),className:"input",placeholder:"Enter last name"}),j.last_name&&(0,a.jsx)("p",{className:"text-sm text-red-600 mt-1",children:j.last_name.message})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),(0,a.jsx)("input",{...y("email"),type:"email",className:"input",placeholder:"Enter email address"}),j.email&&(0,a.jsx)("p",{className:"text-sm text-red-600 mt-1",children:j.email.message})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone"}),(0,a.jsx)("input",{...y("phone"),className:"input",placeholder:"Enter phone number"})]}),(0,a.jsx)("div",{className:"md:col-span-2",children:(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4 mt-6",children:"Property Assignment"})}),(0,a.jsxs)("div",{className:"md:col-span-2",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Assign to Property"}),(0,a.jsxs)("select",{...y("property_id"),className:"input",children:[(0,a.jsx)("option",{value:"",children:"Select a property (optional)"}),h.map(e=>(0,a.jsxs)("option",{value:e.id,children:[e.name," - ",e.address]},e.id))]})]}),(0,a.jsx)("div",{className:"md:col-span-2",children:(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4 mt-6",children:"Lease Information"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Lease Start Date"}),(0,a.jsx)("input",{...y("lease_start_date"),type:"date",className:"input"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Lease End Date"}),(0,a.jsx)("input",{...y("lease_end_date"),type:"date",className:"input"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Monthly Rent"}),(0,a.jsx)("input",{...y("monthly_rent",{valueAsNumber:!0}),type:"number",step:"0.01",className:"input",placeholder:"0.00"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Security Deposit"}),(0,a.jsx)("input",{...y("security_deposit",{valueAsNumber:!0}),type:"number",step:"0.01",className:"input",placeholder:"0.00"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Rent Cadence"}),(0,a.jsxs)("select",{...y("rent_cadence"),className:"input",children:[(0,a.jsx)("option",{value:"",children:"Select rent cadence"}),(0,a.jsx)("option",{value:"weekly",children:"Weekly"}),(0,a.jsx)("option",{value:"bi-weekly",children:"Bi-weekly"}),(0,a.jsx)("option",{value:"monthly",children:"Monthly"})]})]}),(0,a.jsx)("div",{className:"md:col-span-2",children:(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4 mt-6",children:"Emergency Contact"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Emergency Contact Name"}),(0,a.jsx)("input",{...y("emergency_contact_name"),className:"input",placeholder:"Enter emergency contact name"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Emergency Contact Phone"}),(0,a.jsx)("input",{...y("emergency_contact_phone"),className:"input",placeholder:"Enter emergency contact phone"})]}),(0,a.jsxs)("div",{className:"md:col-span-2",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes"}),(0,a.jsx)("textarea",{...y("notes"),rows:3,className:"input",placeholder:"Enter any additional notes"})]})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-3 mt-8",children:[(0,a.jsx)("button",{type:"button",onClick:n,className:"btn btn-secondary",disabled:r,children:"Cancel"}),(0,a.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:r,children:r?(0,a.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(m.Z,{className:"w-4 h-4 mr-2"}),t?"Update Tenant":"Create Tenant"]})})]})]})]})})}function h(){let e=(0,n.useRouter)();return(0,a.jsx)(u,{onSuccess:t=>{x.ZP.success("Tenant created successfully!"),e.push("/tenants")},onCancel:()=>{e.push("/tenants")}})}}},function(e){e.O(0,[334,134,214,286,293,528,744],function(){return e(e.s=342)}),_N_E=e.O()}]);